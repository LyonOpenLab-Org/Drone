<!DOCTYPE html>
<html>
  <head>
    <title>Touch Tracker Marker</title>
    <meta name="viewport" content="width=device-width, user-scalable=no">
<style type="text/css">
body { margin: 0px; overflow: hidden; }
canvas { border: 1px solid black; }
</style>
<script type="text/javascript">

var canvas;
var ctx;
var w = 0;
var h = 0;

var timer;
var updateStarted = false;
var touches = [];
var left=false;
var left=false;
var right=false;
var draw=false;
var couleur;
var x;


function update() {
  if (updateStarted) return;
	updateStarted = true;
	left=false;
	right=false;
	draw=false;
	couleur="rgba(0, 0, 200, 1)";

	var nw = window.innerWidth;
	var nh = window.innerHeight;

	if ((w != nw) || (h != nh)) {
		w = nw;
		h = nh;
		canvas.style.width = w+'px';
		canvas.style.height = h+'px';
		canvas.width = w;
		canvas.height = h;
	}

	drawBackground();

	var i, len = touches.length;
	for (i=0; i<len; i++) {
		var touch = touches[i];
    var px = touch.pageX;
    var py = touch.pageY;
    if(!left && px<w/2) {
    	left=true;
    	draw=true;
	couleur="rgba(200, 0, 0, 1)";
	x=w/4;

    }else if(!right && px>w/2) {
    	right=true;
    	draw=true;
	couleur="rgba(0, 200, 0, 1)";
	x=w/4*3;
    }
    if(draw){
		ctx.beginPath();
		ctx.lineJoin = "round";
		ctx.lineCap = "round";
		ctx.lineWidth = 3.0;
		ctx.moveTo(x+2, h/2+2);
		ctx.moveTo(x-2, h/2-2);
		ctx.lineTo(px-15, py-15);
		ctx.lineTo(px+15, py+15);
		ctx.lineTo(x+2, h/2+2);
		ctx.strokeStyle = couleur;
		ctx.stroke();
		ctx.closePath();
		ctx.fillStyle = couleur;
		ctx.fill();

		ctx.beginPath();
		ctx.arc(px, py, 20, 0, 2*Math.PI, true);
		ctx.fillStyle = couleur;
		ctx.fill();
		ctx.lineWidth = 2.0;
		ctx.strokeStyle = couleur;
		ctx.stroke();
		ctx.closePath();
		
		ctx.beginPath();
		ctx.arc(x, h/2, 3, 0, 2*Math.PI, true);
		ctx.fillStyle = couleur;
		ctx.fill();
		ctx.lineWidth = 2.0;
		ctx.strokeStyle = couleur;
		ctx.stroke();
		ctx.closePath();
    //console.log('drawn circle at ' + px +',' + py);
    }
	}

	updateStarted = false;
}

function drawBackground() {
	ctx.clearRect(0, 0, w, h);
    	var r=Math.min(w/4, h/2);
		ctx.beginPath();
		ctx.arc(w/4, h/2, r-4, 0, 2*Math.PI, true);

		ctx.fillStyle = "rgba(128, 128, 128, 0.2)";
		ctx.fill();

		ctx.lineWidth = 4.0;
		ctx.strokeStyle = "rgba(128, 128, 128, 0.8)";
		ctx.stroke();
		ctx.beginPath();
		ctx.arc(w/4*3, h/2, r-4, 0, 2*Math.PI, true);

		ctx.fillStyle = "rgba(128, 128, 128, 0.2)";
		ctx.fill();

		ctx.lineWidth = 4.0;
		ctx.strokeStyle = "rgba(128, 128, 128, 0.8)";
		ctx.stroke();
}

function ol() {
	canvas = document.getElementById('canvas');
	ctx = canvas.getContext('2d');
	timer = setInterval(update, 15);

canvas.addEventListener('mousedown', function(ev) {
	//alert(ev);
  event.preventDefault();
  touches =[ event];
});

canvas.addEventListener('mousemove', function(ev) {
if(  touches.length>0){
  event.preventDefault();
  touches =[ event];
}
});

canvas.addEventListener('mouseup', function() {
	drawBackground();
  touches =[ ];
});

canvas.addEventListener('touchend', function() {
	drawBackground();
  touches =[ ];
});
canvas.addEventListener('touchmove', function(event) {
  event.preventDefault();
  touches = event.touches;
});

canvas.addEventListener('touchstart', function(event) {
  console.log('start');
});
};

</script>
</head>
<body onload="ol()">
	
<canvas id="canvas" width="300" height="300" style="top:0px; left:0px; width: 300px; height: 300px;"></canvas>

</body>
</html>
